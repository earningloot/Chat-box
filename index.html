<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¨ Color Betting Game ğŸ¨</title>
    <style>
        /* Your existing CSS */
    </style>
</head>
<body>
<div class="container">
    <h1>ğŸ’¸Color TreadingğŸ’¸</h1>
    <div id="walletBalance">ğŸ’° Wallet: â‚¹<span id="balance">99</span></div>
    <button class="btn-deposit" onclick="deposit()">Deposit</button>
    <p>ğŸ’¸ Enter Bet Amount:</p>
    <input type="number" id="betAmount" placeholder="Bet Amount">
    <p>ğŸ¨ Choose a Color:</p>
    <button class="btn-red" onclick="placeBet('red')">Red ğŸ”´</button>
    <button class="btn-green" onclick="placeBet('green')">Green ğŸŸ¢</button>
    <button class="btn-blue" onclick="placeBet('blue')">Blue ğŸ”µ</button>
    <div id="timer">â³ Time Left: <span id="timeLeft">60</span>s | Period: <span id="period">1</span></div>
    <div id="placedBet"></div>
    <div id="resultBanner"></div>
    <h3>ğŸ“œ Last 10 Results</h3>
    <div id="history"></div>
</div>
<script>
    let userBet = null, betAmount = 0, balance = 99;

    async function fetchServerData() {
        const response = await fetch('http://localhost:3000/api/data');
        return await response.json();
    }

    async function updateUI() {
        const serverData = await fetchServerData();
        document.getElementById('timeLeft').innerText = serverData.timer;
        document.getElementById('period').innerText = serverData.period;
        document.getElementById('history').innerHTML = serverData.results.map(result => `<div>${result}</div>`).join('');
    }

    setInterval(updateUI, 1000);

    function deposit() {
        let amount = parseInt(prompt("Enter amount to deposit:"));
        if (isNaN(amount) || amount <= 0) {
            alert("Invalid amount! Please enter a positive number.");
            return;
        }
        balance += amount;
        updateWallet();
    }

    function placeBet(color) {
        betAmount = parseInt(document.getElementById('betAmount').value);
        if (isNaN(betAmount) || betAmount <= 0) {
            alert("Please enter a valid bet amount!");
            return;
        }
        if (betAmount > balance) {
            alert("Insufficient balance!");
            return;
        }
        userBet = color;
        balance -= betAmount;
        updateWallet();
        document.getElementById('betAmount').value = "";
        document.getElementById('placedBet').innerText = `ğŸ“ You placed bet on ${color === 'red' ? 'ğŸ”´ Red' : color === 'green' ? 'ğŸŸ¢ Green' : 'ğŸ”µ Blue'}`;
    }

    function updateWallet() {
        document.getElementById('balance').innerText = balance;
    }

    async function checkResult() {
        const serverData = await fetchServerData();
        if (serverData.timer === 60) {
            const lastResult = serverData.results[0];
            if (lastResult) {
                const resultColor = lastResult.includes('ğŸ”´') ? 'red' : lastResult.includes('ğŸŸ¢') ? 'green' : 'blue';
                if (userBet === resultColor) {
                    const winningAmount = betAmount * 1.98;
                    balance += winningAmount;
                    showResult(`ğŸ’µ Congratulations! You Won â‚¹${winningAmount.toFixed(2)}!`, 'win');
                } else {
                    showResult("âŒï¸ Sorry! You Lost.", 'lose');
                }
                userBet = null;
                document.getElementById('placedBet').innerText = "";
            }
        }
    }

    setInterval(checkResult, 1000);

    function showResult(message, resultClass) {
        const resultBanner = document.getElementById('resultBanner');
        resultBanner.innerText = message;
        resultBanner.className = resultClass;
        setTimeout(() => resultBanner.innerText = "", 3000);
    }
</script>
</body>
</html>
